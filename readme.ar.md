<div dir=rtl>

# I18n
[[English]](readme.md)

مكتبة لتمكين ترجمة النصوص المستخدمة في واجهات المستخدم. هذه المكتبة تحمل الترجمات من ملفات PO.

## الاستخدام

* أضف المكتبة إلى المشروع باستخدام مدير حزم الأسس:

```
اشمل "مـحا"؛
مـحا.اشمل_ملف("Alusus/I18n"، "تـرجمة.أسس")؛
```

<div dir=ltr>

```
import "Apm";
Apm.importFile("Alusus/I18n");
```

</div>

* أنشئ كائنا من صنف `قـاموس` (`Dictionary`) ثم هيئه باستخدام ملف PO:

```
عرف قاموس: تـرجمة.قـاموس؛
قاموس.هيئ(محتوى_po)؛
```

<div dir=ltr>

```
def dict: I18n.Dictionary;
dict.initialize(poContent);
```

</div>

أو، لتهيئة القاموس من ملف:

```
عرف قاموس: تـرجمة.قـاموس؛
قاموس.هيئ(مـتم.نـم.اقرأ_ملف("en.po"))؛
```

<div dir=ltr>

```
def dict: I18n.Dictionary;
dict.initialize(Srl.Fs.readFile("lang.po"));
```

</div>

يمكن أيضًا تحميل النصوص من عدة ملفات PO باستخدام دالة `أضف` (`add`):

```
قاموس.أضف(محتوى_po)؛
```

<div dir=ltr>

```
dict.add(poContent);
```

</div>

أو

```
قاموس.أضف(مـتم.نـم.اقرأ_ملف("en.po"))؛
```

<div dir=ltr>

```
dict.add(Srl.Fs.readFile("lang.po"));
```

</div>

ويمكن استخدام دالة `فرغ` (`clear`) لمحو كل النصوص المحملة.

* استبدل القاموس بسلاسل المحارف المضمنة:

```
طـرفية.اطبع(قاموس("نصي المترجم"))؛
```

<div dir=ltr>

```
Console.print(dict("My localized string"));
```

</div>

## معرفة اتجاه اللغة

لمعرفة اتجاه اللغة، اي معرفة إن كانت تكتب من اليمين أو اليسار، نستخدم دالة `هل_اللغة_يمينية` (`isRightToLeft`):

```
تـرجمة.هل_اللغة_يمينية(نـص("ar")) // ترجع 1
تـرجمة.هل_اللغة_يمينية(نـص("ar_EG")) // ترجع 1
تـرجمة.هل_اللغة_يمينية(نـص("en")) // ترجع 0
```

<div dir=ltr>

```
I18n.isRightToLeft(String("ar")) // returns true
I18n.isRightToLeft(String("ar_EG")) // returns true
I18n.isRightToLeft(String("en")) // returns false
```

</div>

## صنف مـوارد_نصية (TextAssets)

يمكّنك هذا الصنف من تحميل ملفات نصية بعدة لغات من مجلد وتوفيرها تلقائيا كصنف يحتوي خصلة نصية لكل من
هذه الملفات، ثم يحملها لك تلقائيا مقسمة إلى لغات حسب المجلدات المتوفرة. يستقبل هذا الصنف القالب
معطيين، أحدهما مسار مجلد الموارد النصية والآخر اللغة المبدئية، ويطلب أن يحتوي مجلد الموارد النصية
على مجلد لكل لغة برمز اللغة كاسم الجلد، وفي كل من هذه المجلدات توضع الملفات النصية بنفس الأسماء لكل
اللغات. سيعرف الصنف متغيرا لكل من هذه الملفات وسيَحمل المتغير اسم الملف بدون الامتداد.

**ملاحظة:**
هذا الصنف سيحمل الموارد كلها ولكل اللغات أثناء الترجمة وليس أثناء التنفيذ، ما يتيح استخدامه لترجمة
واجهات المستخدم في تطيبقات الويب.

على سبيل المثال، إذا كان لديك المجلد التالي:

<div dir=ltr>

```
assets/
  en/
    file1.txt
    file2.txt
    strings.po
  ar/
    file1.txt
    file2.txt
    strings.po
```

</div>

فبعد تهيئة الصنف سيكون لديك صنف يحتوي على `تـطبيق` (`Map`) فيه مفتاحين: ar و en، ولكل مفتاح نموذج من
الصنف. والصنف في هذه الحالة سيحتوي على ثلاثة متغيرات من صنف `نـص` (`String`) وهي: file1 و file2
و strings.

لتهيئة واستخدام الصنف:

```
تـرجمة.مـوارد_نصية["./الموارد_النصية"، "ar"].هيئ()؛
تـرجمة.مـوارد_نصية["./الموارد_النصية"، "ar"].حدد_اللغة_الحالية(اللغة_الحالية)؛
عرف النصوص: نـص = تـرجمة.مـوارد_نصية["./الموارد_النصية"، "ar"].الحالي.النصوص؛
تـرجمة.هيئ_النصوص(النصوص)؛
طـرفية.اطبع("%s\ج"، تـرجمة.نص("مثال نصي"))؛
```

<div dir=ltr>

```
I18n.TextAssets["./text_assets", "en"].initialize();
I18n.TextAssets["./text_assets", "en"].setCurrentLanguage(currentLang);
def strings: String = I18n.TextAssets["./text_assets", "en"].current.strings;
I18n.initializeStrings(strings);
Console.print("%s\n", I18n.string("string example"));
```

</div>

يمكن الوصول إلى رمز اللغة الحالية باستخدام المتغير `اللغة_الحالية` (`currentLanguage`). يفضل الاعتماد
على هذا المتغير لأنه يضمن عدم استخدام لغة غير متوفرة ضمن الترجمات الحالية. مثلا، لو استدعيت دالة
`حدد_اللغة_الحالية` (`setCurrentLanguage`) برمز لغة غير متوفر ضمن الترجمات فإن الصنف سيختار اللغة
المبدئية بدل اختيار لغة لا ترجمة لها.

### مـوارد_نصية.هات_اللغات_المتوفرة (TextAssets.getAvailableLanguages)

ترجع هذه الدالة قائمة باللغات المتوفرة. يجب أن تُستدعى دالة `هيئ` (`initialize`) قبل استدعاء هذه
الدالة. تحرص هذه الدالة على وضع اللغة المبدئية في مقدمة المصفوفة المرجعة.

```
دالة هات_اللغات_المتوفرة(): مـصفوفة[نـص]؛
```

<div dir=ltr>

```
func getAvailableLanguages(): Array[String];
```

</div>

</div>

